# 1. 用户画像

由于 web 程序使用的前后端分离的设计模式，使得统计地址与功能映射是一件很费劲的事情。
同时，设计者对于用户的操作是否合规仍然抱有兴趣，所以本程序试图实现使用本地Web应用程序日志，构建用户画像来分析用户行为。

## 1.1. 数据预处理

这一步的目的，通过去除噪音，去除干扰点，得到按照 `userID` 来区分的日志文件，且按照 `date` 进行排序。

### 1.1.1. 数据整合

- [ ] 将原始数据按照 `userID` 提取
- [ ] 提取后的数据按照 `date` 排序
- [ ] 在提取过程中，去除无关请求和机器人请求

### 1.1.2. URL 去重

在整个系统中，存在很多附加了参数的url，urlA 和 urlB 其实就是同一个功能点，下表就是一个例子。

| URL                                                                     | 模板                                     |
|:-----------------------------------------------------------------------:|:----------------------------------------:|
| /fa/asset/assetInfo/getAssetInfoVoById/1284b81cc18a4ae0a87918568eddcb28 | /fa/asset/assetInfo/getAssetInfoVoById/* |
| /fa/asset/assetInfo/getAssetInfoVoById/151bc91b3df74cc8ad27c653427173ca | 相同                                     |
| /fa/asset/assetInfo/getAssetInfoVoById/184c952d67a143e1a80e51381c3857bf | 相同                                     |
| /fa/asset/assetInfo/getAssetInfoVoById/1874faa37d3348a8a1d56fb3fbb3fa84 | 相同                                     |

#### 1.1.2.1. 思路

设计“分割-重组”的方法，按照 `/` 做分割，分割出来的每一个子串作为一个基本单元，记为 `1,2,3,4....`，则判断方法如下：

1. 仅有一个子串不同，其他皆相同，则认为这是一个模板。
`1->2->3->6->5`
`1->2->3->7->5`
`1->2->3->8->5`
归纳模板为:
`1->2->3->*->5`
2. 找不到第二个 url，与当前url有且仅有一个子串相同，则此url是一个模板。

## 1.2. 序列模式挖掘

用户行为序列的挖掘，意图找到用户在一段时间内的操作跳转。

调研方法如下

| 算法           | AprioriAll | GSP      | FreeSpan | PrefixSpan |
| -------------- | ---------- | -------- | -------- | ---------- |
| 存储结构       | Hashtree   | Hashtree | Hashtree | WAP 树     |
| 候选序列       | 产生       | 产生     | 不产生   | 不产生     |
| 数据库分割     | 否         | 否       | 是       | 是         |
| 数据库扫描次数 | 多次       | 多次     | 3 次     | 2 次       |
| 执行方式       | 循环       | 循环     | 递归     | 递归       |
| 时空效率       | 较低       | 较低     | 较高     | 较高       |

### 1.2.1. PrefixSpan 算法描述

### 1.2.2. 多维度刻画用户画像

- **用户自然属性**： 姓名、性别、年龄、邮箱、电话、职业
- **兴趣属性**： 访问的页面，使用的功能，访问路径
- **地理信息**： 通过ip反查地址
- **设备属性**： 登录桌面，使用系统
- **隐含属性**

ceshi